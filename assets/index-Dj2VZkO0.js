(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(t){if(t.ep)return;t.ep=!0;const o=n(t);fetch(t.href,o)}})();const c=document.querySelector(".temp__title");document.querySelector(".temp__description");const f=document.querySelector(".wheel__button"),p=document.querySelector(".wheel__base"),m=document.querySelector(".spin-block__godzilla"),_=[{name:"200 000 ₸",start:337.5,end:22.5},{name:"Повтор",start:22.5,end:67.5},{name:"100 000 ₸",start:67.5,end:112.5},{name:"Бонус +",start:112.5,end:157.5},{name:"150 000 ₸",start:157.5,end:202.5},{name:"Повтор",start:202.5,end:247.5},{name:"Повтор",start:247.5,end:292.5},{name:"100 000 ₸",start:292.5,end:337.5}];function h(r){const e=(r%360+360)%360;return _.find(n=>n.start<n.end?e>=n.start&&e<n.end:e>=n.start||e<n.end)}function g(){c.classList.add("temp__title--loading"),c.textContent="Загрузка температуры..."}async function y(){try{const e=await(await fetch("http://localhost:3000/api/weather")).json();if(!e.current)throw new Error("No temperature data");c.textContent=`${e.current.temperature}°C`,c.classList.remove("temp__title--loading")}catch{c.textContent="Температура недоступна"}}let i=!1;f.addEventListener("click",()=>{i||(i=!0,v())});function v(){const r=Math.floor(Math.random()*360),e=360*6+r,n=5e3,a=s=>1-Math.pow(1-s,3),t=performance.now();function o(s){const u=s-t,l=Math.min(u/n,1),d=a(l)*e;p.style.transform=`rotate(${d}deg)`,l<1?requestAnimationFrame(o):b(d)}requestAnimationFrame(o)}function b(r){const e=h(r);console.log("Результат:",e.name);const n=e.name.includes("₸")||e.name.includes("Бонус");L(n,e.name)}function L(r,e){m.classList.add("roar"),setTimeout(()=>{m.classList.remove("roar"),r&&w(e),i=!1},1e3)}function w(r){const e=document.createElement("div");e.className="modal",e.innerHTML=`
    <div class="modal__content modal--prize">
      <button class="modal__close">×</button>
      <h2 class="modal__title">Вы выиграли</h2>

      <div class="modal__prize-box">
        <img src="./src/img/prize-banner.png" alt="Приз" class="modal__banner" />
        <div class="modal__amount">${r}</div>
      </div>

      <button class="modal__claim">Забрать бонус</button>
    </div>
  `,document.body.appendChild(e);const n=e.querySelector(".modal__close"),a=e.querySelector(".modal__claim");n.addEventListener("click",()=>e.remove()),a.addEventListener("click",()=>{alert("Бонус отправлен!"),e.remove()})}g();y();
